<!DOCTYPE html>
<html>
<head>
  <title>AI Study Tracker</title>
</head>
<body>
  <h1>AI Study Tracker</h1>

  <input id="subjectInput" placeholder="Enter subject">
  <button onclick="addSubject()">Add</button>

  <ul id="list"></ul>

  <script>
    const list = document.getElementById("list");

    function render(subjects) {
      list.innerHTML = "";
      subjects.forEach((s, i) => {
        const li = document.createElement("li");

        const text = document.createElement("span");
        text.textContent = s.name;
        if (s.completed) text.style.textDecoration = "line-through";
        text.onclick = () => toggle(i);

        const del = document.createElement("button");
        del.textContent = "X";
        del.onclick = () => remove(i);

        li.appendChild(text);
        li.appendChild(del);
        list.appendChild(li);
      });
    }

    async function load() {
      const res = await fetch("/api/subjects");
      render(await res.json());
    }

    async function addSubject() {
      const input = document.getElementById("subjectInput");
      if (!input.value) return;

      const res = await fetch("/api/subjects", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name: input.value })
      });

      render(await res.json());
      input.value = "";
    }

    async function toggle(i) {
      const res = await fetch(`/api/subjects/${i}`, { method: "PUT" });
      render(await res.json());
    }

    async function remove(i) {
      const res = await fetch(`/api/subjects/${i}`, { method: "DELETE" });
      render(await res.json());
    }

    load();
  </script>
</body>
</html>
